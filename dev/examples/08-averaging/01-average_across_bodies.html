
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Average across bodies &#8212; PyDPF-Core</title>
    
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css\ansys_sphinx_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    
        <link href="../../_static/css/breadcrumbs.css" rel="stylesheet">
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../../_static/ansys-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Mesh operations examples" href="../09-mesh_operations/index.html" />
    <link rel="prev" title="Averaging order" href="00-compute_and_average.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/pyansys-logo-black-cropped.png" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/pyansys-logo-black-cropped.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user_guide/index.html">
  User guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../concepts/index.html">
  Concepts
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../operator_reference.html">
  Operators
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../contributing.html">
  Contribute
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        dev  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables examples/08-averaging/01-average_across_bodies and {'json_url': 'https://nocname.com/release/versions.json', 'version_match': 'dev'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "examples/08-averaging/01-average_across_bodies.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://nocname.com/release/versions.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "examples/08-averaging/01-average_across_bodies.html";
        let btn = document.getElementById("version_switcher_button");
        // Set empty strings by default so that these attributes exist and can be used in CSS selectors
        btn.dataset["activeVersionName"] = "";
        btn.dataset["activeVersion"] = "";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 0.7.3.dev0 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "dev") {
                node.classList.add("active");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyansys/pydpf-core" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    
     
<div id="announcement_msg"></div>
<script>
  fetch("announcement.html")
    .then((response) => {
      if (!response.ok) {
        throw new Error(`HTTP error: ${response.status}`);
      }
      return response.text();
    })
    .then(text => document.getElementById("announcement_msg").innerHTML = text)
    .catch((error) => console.error(`Fetch problem: ${error.message}`));
</script>

    
        <div class="container-xl">
    <div class="row">
        <div class="col-12 col-md-3" id="breadcrumbs-spacer"></div>
        <div class="col-12 col-md-11 col-xl-9" id="breadcrumbs">
          
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
    
        <li class="nav-item nav-item-additional-breadcrumb"><a href="https://docs.pyansys.com/">PyAnsys</a> » </li>
    
    
        <li class="nav-item nav-item-0"><a href="../../index.html">PyDPF-Core</a> » </li>
    

          <li class="nav-item nav-item-1"><a href="../index.html" >Examples</a> » </li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Averaging examples</a> » </li>
        <li class="nav-item nav-item-this"><a href="">Average across bodies</a></li> 
      </ul>
    </div>
        </div>
  </div>
</div>
    


    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../00-basic/index.html">
   Basic DPF examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/00-basic_example.html">
     Basic DPF-Core usage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/01-basic_operators.html">
     Operators overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/02-basic_field_containers.html">
     Field and field containers overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/03-create_entities.html">
     Create your own entities using DPF operators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/05-use_local_data.html">
     Bring a field’s data locally to improve performance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/07-use_result_helpers.html">
     Use result helpers to load custom data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/08-results_over_time_subset.html">
     Scope results over custom time domains
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/09-results_over_space_subset.html">
     Scope results over custom space domains
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/11-server_types.html">
     Communicate in process or via gRPC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-basic/12-get_material_properties.html">
     Get material properties from the result file
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-transient_analyses/index.html">
   Transient analysis examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-transient_analyses/00-basic_transient.html">
     Transient analysis result example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-transient_analyses/01-transient_easy_time_scoping.html">
     Choose a time scoping for a transient analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-transient_analyses/02-lsdyna_operators.html">
     Results extraction and analysis from LS-DYNA sources
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-modal-harmonic/index.html">
   Harmonic analysis examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-modal-harmonic/00-multi_harmonic.html">
     Multi-harmonic response example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-modal-harmonic/01-modal_cyclic.html">
     Modal cyclic symmetry example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-modal-harmonic/02-cyclic_multi_stage.html">
     Multi-stage cyclic symmetry example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-modal-harmonic/03-compare_modes.html">
     Use Result Helpers to compare mode shapes for solids and then shells
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-modal-harmonic/04-modal_superposition.html">
     Expand harmonic modal superposition with DPF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-modal-harmonic/05-read_distributed_files.html">
     Read results from distributed files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-modal-harmonic/06-cycles_to_failure.html">
     Calculate the number of cycles to fatigue failure
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-advanced/index.html">
   Advanced and miscellaneous examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-advanced/00-multistage_advanced_options.html">
     Multi-stage cyclic symmetry using advanced customization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-advanced/01-solve_harmonic_problem.html">
     Solve harmonic problem (with damping) using matrix inverse
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-advanced/02-volume_averaged_stress.html">
     Average elemental stress on a given volume
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-advanced/03-exchange_data_between_servers.html">
     Exchange data between servers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-advanced/04-extrapolation_stress_3d.html">
     Extrapolation method for stress result of a 3D element
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-advanced/05-extrapolation_strain_2d.html">
     Extrapolation method for strain result of a 2D element
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-advanced/06-stress_gradient_path.html">
     Stress gradient normal to a defined node
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-advanced/07-load_plugin.html">
     Load plugin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-advanced/10-asme_secviii_divtwo.html">
     Pressure vessel analysis according to an ASME standard
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04-file-IO/index.html">
   File manipulation and input-output examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-file-IO/00-hdf5_double_float_comparison.html">
     HDF5 export and compare precision
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-file-IO/01-reduced_matrices_export.html">
     Get reduced matrices and make export
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-file-IO/04-basic-load-file.html">
     Working with a result file
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05-plotting/index.html">
   Plotting examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-plotting/00-basic_plotting.html">
     Review of available plotting commands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-plotting/01-compare_results.html">
     Compare results using the plotter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-plotting/02-solution_combination.html">
     Load case combination for principal stress
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-plotting/03-labels.html">
     Add nodal labels on plots
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-plotting/04-plot_on_path.html">
     Plot results on a specific path
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-plotting/05-plot_on_warped_mesh.html">
     Warp the mesh by a field for plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-plotting/06-animate_results.html">
     Review of available animation commands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-plotting/07-plot_on_geometries.html">
     Plot on geometry elements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06-distributed-post/index.html">
   Examples for postprocessing on distributed processes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-distributed-post/00-distributed_total_disp.html">
     Postprocessing of displacement on distributed processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-distributed-post/01-distributed_workflows_on_remote.html">
     Create a custom workflow on distributed processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-distributed-post/02-distributed-msup_expansion.html">
     Distributed mode superposition (MSUP)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-distributed-post/03-distributed-msup_expansion_steps.html">
     Distributed MSUP distributed modal response
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-distributed-post/06-distributed_stress_averaging.html">
     Average Stress in distributed Workflows
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../07-python-operators/index.html">
   Examples of creating custom operator plugins
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-python-operators/00-wrapping_numpy_capabilities.html">
     Create a basic operator plugin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-python-operators/01-package_python_operators.html">
     Create a plug-in package with multiple operators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-python-operators/02-python_operators_with_dependencies.html">
     Create a plug-in package that has third-party dependencies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Averaging examples
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="00-compute_and_average.html">
     Averaging order
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Average across bodies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../09-mesh_operations/index.html">
   Mesh operations examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../09-mesh_operations/00-create_polygons_and_polyhedrons.html">
     Create and display a mesh with polygon and polyhedron elements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09-mesh_operations/05-skin_extraction.html">
     Extract the skin from a mesh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09-mesh_operations/13-nodes_in_local_coordinate_system.html">
     Convert nodal coordinates field to local coordinate system
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Average across bodies
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#averaging-across-bodies-with-dpf">
   Averaging across bodies with DPF
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#averaging-across-bodies-activated">
     Averaging across bodies activated
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#averaging-across-bodies-deactivated">
     Averaging across bodies deactivated
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-and-compare-the-results">
   Plot and compare the results
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-08-averaging-01-average-across-bodies-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="average-across-bodies">
<span id="ref-average-across-bodies"></span><span id="sphx-glr-examples-08-averaging-01-average-across-bodies-py"></span><h1>Average across bodies<a class="headerlink" href="#average-across-bodies" title="Permalink to this heading">#</a></h1>
<p>This example shows how to activate and deactivate the DPF option for averaging
across bodies. When a multi-body simulation calculates <code class="docutils literal notranslate"><span class="pre">ElementalNodal</span></code> fields,
like stresses or strains, you can either activate or deactivate the averaging
of these fields across the different bodies when they share common nodes. This
likely changes the end results that are shown after postprocessing of the simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example requires the Premium ServerContext.
For more information, see <a class="reference internal" href="../../user_guide/server_context.html#user-guide-server-context"><span class="std std-ref">Server context</span></a>.</p>
</div>
<p>Perform the required imports.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ansys.dpf</span> <span class="kn">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">dpf</span>
<span class="kn">from</span> <span class="nn">ansys.dpf.core</span> <span class="kn">import</span> <span class="n">operators</span> <span class="k">as</span> <span class="n">ops</span>
<span class="kn">from</span> <span class="nn">ansys.dpf.core</span> <span class="kn">import</span> <span class="n">examples</span>


<span class="n">dpf</span><span class="o">.</span><span class="n">set_default_server_context</span><span class="p">(</span><span class="n">dpf</span><span class="o">.</span><span class="n">AvailableServerContexts</span><span class="o">.</span><span class="n">premium</span><span class="p">)</span>
</pre></div>
</div>
<p>Load the simulation results from an RST file and create a model of it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">download_piston_rod</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>DPF Model
------------------------------
Static analysis
Unit system: MKS: m, kg, N, s, V, A, degC
Physics Type: Mechanical
Available results:
     -  displacement: Nodal Displacement
     -  reaction_force: Nodal Force
     -  stress: ElementalNodal Stress
     -  elemental_volume: Elemental Volume
     -  stiffness_matrix_energy: Elemental Energy-stiffness matrix
     -  artificial_hourglass_energy: Elemental Hourglass Energy
     -  thermal_dissipation_energy: Elemental thermal dissipation energy
     -  kinetic_energy: Elemental Kinetic Energy
     -  co_energy: Elemental co-energy
     -  incremental_energy: Elemental incremental energy
     -  elastic_strain: ElementalNodal Strain
     -  structural_temperature: ElementalNodal Temperature
------------------------------
DPF  Meshed Region:
  33337 nodes
  18235 elements
  Unit: m
  With solid (3D) elements
------------------------------
DPF  Time/Freq Support:
  Number of sets: 3
Cumulative     Time (s)       LoadStep       Substep
1              1.000000       1              1
2              2.000000       2              1
3              3.000000       3              1
</pre></div>
</div>
<p>To take a look at the system to see how bodies are connected to each other,
extract the mesh of the model and then divide it into different meshes
using the <code class="docutils literal notranslate"><span class="pre">split_mesh</span></code> operator.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mesh</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">meshed_region</span>
<span class="n">split_mesh_op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">split_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="s2">&quot;mat&quot;</span><span class="p">)</span>
<span class="n">meshes</span> <span class="o">=</span> <span class="n">split_mesh_op</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">meshes</span><span class="p">()</span>

<span class="n">meshes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Body meshes&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_01-average_across_bodies_001.png" srcset="../../_images/sphx_glr_01-average_across_bodies_001.png" alt="01 average across bodies" class = "sphx-glr-single-img"/><p>As you can see in the preceding image, even though the piston rod is one single part,
it is composed of two different bodies. Additionally, you can see that the region
where the two bodies are bonded together contains nodes that are common between them.</p>
</section>
<section id="averaging-across-bodies-with-dpf">
<h1>Averaging across bodies with DPF<a class="headerlink" href="#averaging-across-bodies-with-dpf" title="Permalink to this heading">#</a></h1>
<p>To take a look at how the option for averaging across bodies alters the results
of the simulation, define two workflows. The first workflow does averaging across
bodies, while the second workflow does not. The variable of interest is the stress
in the Z direction, which is obtained using the “stress_Z” operator.</p>
<div class="graphviz"><img src="../../_images/graphviz-f9b2ff0f61f7f8ab5e13bab492015c7a21d63a54.png" alt="digraph foo {
    graph [pad=&quot;0&quot;, nodesep=&quot;0.3&quot;, ranksep=&quot;0.3&quot;]
    node [shape=box, style=filled, fillcolor=&quot;#ffcc0&quot;, margin=&quot;0&quot;];
    rankdir=LR;
    splines=line;
    node [fixedsize=true,width=2.5]
    stress01 [label=&quot;stress_Z&quot;];
    stress02 [label=&quot;stress_Z&quot;];
    scp01 [label=&quot;split_on_property_type&quot;];
    subgraph cluster_1 {
        ds01 [label=&quot;data_src&quot;, shape=box, style=filled, fillcolor=cadetblue2];
        ds01 -&gt; scp01 [style=dashed];
        scp01 -&gt; stress01;
        label=&quot;Averaging across bodies = Off&quot;;
        style=filled;
        fillcolor=lightgrey;
    }
    subgraph cluster_2 {
        ds02 [label=&quot;data_src&quot;, shape=box, style=filled, fillcolor=cadetblue2];
        inv02 [style=invisible]
        ds02 -&gt; stress02 [style=dashed];
        stress02 -&gt; inv02 [style=invis]
        label=&quot;Averaging across bodies = On&quot;;
        style=filled;
        fillcolor=lightgrey;
    }
}" class="graphviz" /></div>
<section id="averaging-across-bodies-activated">
<h2>Averaging across bodies activated<a class="headerlink" href="#averaging-across-bodies-activated" title="Permalink to this heading">#</a></h2>
<p>The extraction of the stresses in the Z direction applies averaging
across bodies by default. Thus, you can use a simple workflow.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">average_across_bodies</span><span class="p">(</span><span class="n">analysis</span><span class="p">):</span>
    <span class="c1"># Extract the stresses in the Z direction (with the average</span>
    <span class="c1"># across bodies property activated) and plot them.</span>

    <span class="c1"># Create a model from the simulation results.</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">meshed_region</span>

    <span class="c1"># Set the time set of interest to the last time set.</span>
    <span class="n">time_set</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="c1"># Extract the stresses in the Z direction. By default, DPF already applies</span>
    <span class="c1"># averaging across bodies when extracting the stresses.</span>
    <span class="n">stress_op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">stress_Z</span><span class="p">()</span>
    <span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">time_scoping</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">time_set</span><span class="p">)</span>
    <span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">requested_location</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dpf</span><span class="o">.</span><span class="n">locations</span><span class="o">.</span><span class="n">nodal</span><span class="p">)</span>
    <span class="n">stresses</span> <span class="o">=</span> <span class="n">stress_op</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">fields_container</span><span class="p">()</span>

    <span class="c1"># Find the maximum stress value.</span>
    <span class="n">min_max</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">operators</span><span class="o">.</span><span class="n">min_max</span><span class="o">.</span><span class="n">min_max_fc</span><span class="p">()</span>
    <span class="n">min_max</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fields_container</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">stresses</span><span class="p">)</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="n">min_max</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">field_max</span><span class="p">()</span>

    <span class="n">mesh</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stresses</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Averaged across bodies&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_val</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="averaging-across-bodies-deactivated">
<h2>Averaging across bodies deactivated<a class="headerlink" href="#averaging-across-bodies-deactivated" title="Permalink to this heading">#</a></h2>
<p>The workflow is more complicated for extracting the stresses without
averaging across the bodies of the simulated part. Instead of presenting
the workflow as a function, it is broken into various parts with explanations
of what is being done.</p>
<p>Create a model from the simulation results and extract its mesh and
step information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">meshed_region</span>
<span class="n">time_freq</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">time_freq_support</span>
<span class="n">time_sets</span> <span class="o">=</span> <span class="n">time_freq</span><span class="o">.</span><span class="n">time_frequencies</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
<p>Split the meshes of the two bodies so that separate scopings can be
created for each one of them. The <cite>‘mat’`</cite> label is used to split the mesh
by bodies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_scop_op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">scoping</span><span class="o">.</span><span class="n">split_on_property_type</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="s2">&quot;mat&quot;</span><span class="p">)</span>
<span class="n">mesh_scop_cont</span> <span class="o">=</span> <span class="n">mesh_scop_op</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">mesh_scoping</span><span class="p">()</span>
</pre></div>
</div>
<p>Given that there are three different time steps, create a scopings container
that contains the meshes of each of these time steps.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scop_cont</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">ScopingsContainer</span><span class="p">()</span>
<span class="n">scop_cont</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">)</span>
<span class="n">scop_cont</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tset</span> <span class="ow">in</span> <span class="n">time_sets</span><span class="p">:</span>
    <span class="n">body</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">mesh_scop</span> <span class="ow">in</span> <span class="n">mesh_scop_cont</span><span class="p">:</span>
        <span class="n">scop_cont</span><span class="o">.</span><span class="n">add_scoping</span><span class="p">(</span><span class="n">scoping</span><span class="o">=</span><span class="n">mesh_scop</span><span class="p">,</span> <span class="n">label_space</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">tset</span><span class="p">)})</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scop_cont</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>DPF Scopings Container with
        6 scoping(s)
        defined on labels [&#39;body&#39;, &#39;time&#39;]
</pre></div>
</div>
<p>The scopings container has six different scopings, one for each body over
each of the three time steps.</p>
<p>Set the time set of interest to the last time set.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_set</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
<p>To retrieve the Z stresses without averaging across the two bodies, you must
pass a scopings container that contains their respective meshes as a parameter
to the <code class="docutils literal notranslate"><span class="pre">stress_Z</span></code> operator. To do this, create a scopings container that contains
the meshes of the two bodies in the desired time step.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scop_list</span> <span class="o">=</span> <span class="n">scop_cont</span><span class="o">.</span><span class="n">get_scopings</span><span class="p">(</span><span class="n">label_space</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">time_set</span><span class="p">})</span>
<span class="n">scopings</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">ScopingsContainer</span><span class="p">()</span>
<span class="n">scopings</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">)</span>
<span class="n">body</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">scop</span> <span class="ow">in</span> <span class="n">scop_list</span><span class="p">:</span>
    <span class="n">scopings</span><span class="o">.</span><span class="n">add_scoping</span><span class="p">(</span><span class="n">label_space</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">},</span> <span class="n">scoping</span><span class="o">=</span><span class="n">scop</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scopings</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>DPF Scopings Container with
        2 scoping(s)
        defined on labels [&#39;body&#39;]
</pre></div>
</div>
<p>This contain has only two scopings, one for each body in the last time step.</p>
<p>Extract the stresses in the Z direction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stress_op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">stress_Z</span><span class="p">()</span>
<span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">time_scoping</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">time_set</span><span class="p">)</span>
<span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">mesh_scoping</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">scopings</span><span class="p">)</span>  <span class="c1"># This option deactivates averaging across bodies.</span>
<span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">requested_location</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dpf</span><span class="o">.</span><span class="n">locations</span><span class="o">.</span><span class="n">nodal</span><span class="p">)</span>
<span class="n">stresses</span> <span class="o">=</span> <span class="n">stress_op</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">fields_container</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stresses</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>DPF stress(s)Fields Container
  with 2 field(s)
  defined on labels: body time

  with:
  - field 0 {body:  1, time:  3} with Nodal location, 1 components and 17281 entities.
  - field 1 {body:  2, time:  3} with Nodal location, 1 components and 17610 entities.
</pre></div>
</div>
<p>Find the maximum value of the stress field for comparison purposes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">min_max</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">operators</span><span class="o">.</span><span class="n">min_max</span><span class="o">.</span><span class="n">min_max_fc</span><span class="p">()</span>
<span class="n">min_max</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fields_container</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">stresses</span><span class="p">)</span>
<span class="n">max_val</span> <span class="o">=</span> <span class="n">min_max</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">field_max</span><span class="p">()</span>
</pre></div>
</div>
<p>Define the preceding workflow as a function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">not_average_across_bodies</span><span class="p">(</span><span class="n">analysis</span><span class="p">):</span>
    <span class="c1"># This function extracts the stresses in the Z direction (with the average</span>
    <span class="c1"># across bodies option deactivated) and plot them.</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">meshed_region</span>

    <span class="n">time_freq</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">time_freq_support</span>
    <span class="n">time_sets</span> <span class="o">=</span> <span class="n">time_freq</span><span class="o">.</span><span class="n">time_frequencies</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">mesh_scop_op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">scoping</span><span class="o">.</span><span class="n">split_on_property_type</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="s2">&quot;mat&quot;</span><span class="p">)</span>
    <span class="n">mesh_scop_cont</span> <span class="o">=</span> <span class="n">mesh_scop_op</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">mesh_scoping</span><span class="p">()</span>

    <span class="n">scop_cont</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">ScopingsContainer</span><span class="p">()</span>
    <span class="n">scop_cont</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">)</span>
    <span class="n">scop_cont</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tset</span> <span class="ow">in</span> <span class="n">time_sets</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">mesh_scop</span> <span class="ow">in</span> <span class="n">mesh_scop_cont</span><span class="p">:</span>
            <span class="n">scop_cont</span><span class="o">.</span><span class="n">add_scoping</span><span class="p">(</span><span class="n">scoping</span><span class="o">=</span><span class="n">mesh_scop</span><span class="p">,</span> <span class="n">label_space</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">tset</span><span class="p">)})</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">time_set</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">scop_list</span> <span class="o">=</span> <span class="n">scop_cont</span><span class="o">.</span><span class="n">get_scopings</span><span class="p">(</span><span class="n">label_space</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">time_set</span><span class="p">})</span>
    <span class="n">scopings</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">ScopingsContainer</span><span class="p">()</span>
    <span class="n">scopings</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">scop</span> <span class="ow">in</span> <span class="n">scop_list</span><span class="p">:</span>
        <span class="n">scopings</span><span class="o">.</span><span class="n">add_scoping</span><span class="p">(</span><span class="n">label_space</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">},</span> <span class="n">scoping</span><span class="o">=</span><span class="n">scop</span><span class="p">)</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">stress_op</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">stress_Z</span><span class="p">()</span>
    <span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">time_scoping</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">time_set</span><span class="p">)</span>
    <span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">mesh_scoping</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">scopings</span><span class="p">)</span>
    <span class="n">stress_op</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">requested_location</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dpf</span><span class="o">.</span><span class="n">locations</span><span class="o">.</span><span class="n">nodal</span><span class="p">)</span>
    <span class="n">stresses</span> <span class="o">=</span> <span class="n">stress_op</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">fields_container</span><span class="p">()</span>

    <span class="n">min_max</span> <span class="o">=</span> <span class="n">dpf</span><span class="o">.</span><span class="n">operators</span><span class="o">.</span><span class="n">min_max</span><span class="o">.</span><span class="n">min_max_fc</span><span class="p">()</span>
    <span class="n">min_max</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fields_container</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">stresses</span><span class="p">)</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="n">min_max</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">field_max</span><span class="p">()</span>

    <span class="n">meshes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stresses</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Not averaged across bodies&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_val</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="plot-and-compare-the-results">
<h1>Plot and compare the results<a class="headerlink" href="#plot-and-compare-the-results" title="Permalink to this heading">#</a></h1>
<p>Plot and compare the results. The first plot shows the stress distribution
when averaging across bodies is activated. The second plot shows the stress
distribution when averaging across bodies is deactivated.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_avg_on</span> <span class="o">=</span> <span class="n">average_across_bodies</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
<span class="n">max_avg_off</span> <span class="o">=</span> <span class="n">not_average_across_bodies</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_01-average_across_bodies_002.png" srcset="../../_images/sphx_glr_01-average_across_bodies_002.png" alt="01 average across bodies" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_01-average_across_bodies_003.png" srcset="../../_images/sphx_glr_01-average_across_bodies_003.png" alt="01 average across bodies" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">max_avg_on</span> <span class="o">-</span> <span class="n">max_avg_off</span><span class="p">)</span> <span class="o">/</span> <span class="n">max_avg_off</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max stress when averaging across bodies is activated: </span><span class="si">{:.2f}</span><span class="s2"> Pa&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_avg_on</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max stress when averaging across bodies is deactivated: </span><span class="si">{:.2f}</span><span class="s2"> Pa&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_avg_off</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The maximum stress value when averaging across bodies is ACTIVATED </span><span class="se">\</span>
<span class="s2">is </span><span class="si">{:.2f}</span><span class="s2">% LOWER than when it is DEACTIVATED&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">diff</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Max stress when averaging across bodies is activated: 6958243299.56 Pa
Max stress when averaging across bodies is deactivated: 6988756864.00 Pa
The maximum stress value when averaging across bodies is ACTIVATED is 0.44% LOWER than when it is DEACTIVATED
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  4.487 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-08-averaging-01-average-across-bodies-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/2e83048bea6393f9b6a5eeb1dada3999/01-average_across_bodies.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">01-average_across_bodies.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b7318139122dda9abe6a578f3d6c1b83/01-average_across_bodies.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">01-average_across_bodies.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright (c) 2023 ANSYS, Inc. All rights reserved.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>